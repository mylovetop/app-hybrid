/*! p2p 2015-01-16 */
angular.module(Constant.CONTROLLER).controller(Constant.CTRL_MEMBER,["$scope","$rootScope",Constant.SERVICE_USER,function(a,b,c){var d="0";Common.setRouteTopBarBack(Constant.ROUTE_PROJECT_LIST),a.topBar={titleLeft:"会员中心",route:Constant.ROUTE_MEMBER,titleRight:Constant.KEY_LOGIN_OK},a.user=JSON.parse(Common.getLocalStorage(Constant.KEY_USER));var e=function(b,c,d){a.incomeInfo={collectedInterest:b,shouldCollectTotal:c,collectedTotal:d}};e(d,d,d);var f=function(){c.memberCenter().success(function(a){var b=JSON.parse(a);"{}"!=b&&g(JSON.parse(b))}).error(function(a){console.log(a)})},g=function(a){var b=d,c=d,f=d,g=a.incomeInfo,h=g.collectedInterest;null!=h&&(b=h);var i=g.shouldCollectTotal;null!=i&&(c=i);var j=g.collectedTotal;null!=j&&(f=j),e(b,c,f)};a.cssLogout="tip-hide",a.cssLogin="tip-hide";var h=function(){c.isLogin().success(function(b){var c=JSON.parse(b);Common.setLogin(c),c-0?(a.topBar.titleRight=Constant.KEY_LOGIN_FAIL,f()):a.topBar.titleRight=Constant.KEY_LOGIN_OK}).error(function(){Common.setLogin("0")})};h(),a.logout=function(){c.logout().success(function(){Common.setLogin(0),h(),i({message:"成功退出",cssTip:"tip",count:a.dTip.count+1}),setTimeout(function(){a.back(Constant.ROUTE_PROJECT_LIST),a.$apply()},500)})},a.login=function(){a.go(Constant.ROUTE_LOGIN)},a.goInvestList=function(){var b=Common.getLogin()-0;a.go(b?Constant.ROUTE_INVEST:Constant.ROUTE_LOGIN)};var i=function(b){a.dTip={message:b.message,cssTip:b.cssTip,count:b.count}};i({message:"",cssTip:"",count:0})}]);
/*! p2p 最后修改于： 2015-01-16 */