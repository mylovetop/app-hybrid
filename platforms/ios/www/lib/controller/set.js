/*! p2p 2015-01-16 */
angular.module(Constant.CONTROLLER).controller(Constant.CTRL_SET,["$scope","$rootScope",Constant.SERVICE_USER,function(a,b,c){Common.setRouteTopBarBack(Constant.ROUTE_PROJECT_LIST),a.topBar={titleLeft:"设置",route:Constant.ROUTE_SET,titleRight:""},a.cssUpdateIcon="",a.updateClick=function(){a.cssUpdateIcon="set-update-icon-run",e()};var d=function(b){a.dTip={message:b.message,cssTip:b.cssTip,count:b.count}};d({message:"",cssTip:"",count:0}),a.showDialog=!1;var e=function(){c.updateVersion().success(function(b){try{var c=b.version}catch(e){console.log(e)}var f="已经是最新版本";return c>Constant.DATA_VERSION?(a.showDialog=!0,void(a.cssUpdateIcon="")):(d({message:f,cssTip:"tip",count:a.dTip.count+1}),void(a.cssUpdateIcon=""))}).error(function(){d({message:"版本检测失败",cssTip:"tip",count:a.dTip.count+1}),a.cssUpdateIcon=""})},f=function(){a.showDialog=!1},g=function(){Common.isIos()?window.location.href=Constant.APP_URL:navigator.app.loadUrl(Constant.URL+Constant.APP_URL_ANDROID,{openExternal:!0})};a.dialog={dialogTitle:"有新版本",dialogContent:"是否更新",dialogFooterLeft:"暂不更新",dialogFooterRight:"立即更新",btnLeftClick:f,btnRightClick:g}}]);
/*! p2p 最后修改于： 2015-01-16 */